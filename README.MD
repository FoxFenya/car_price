# Проект "Стоимость автомобиля на вторичном рынке"
*Спринт Мастерская 1*

## Постановка задачи
Заказчик: Агентство по подбору автомобилей со вторичного рынка.

Необходимо разработать модель, которая поможет спрогнозировать стоимость автомобиля на вторичном рынке. Тем самым заказчик планирует создавать перечини автомобилей по пожеланиям клиентов учитывая как ограничения по стоимости, так пожелания по маркам.

Агентство объявило конкурс на платформе Kaggle. Для тестирования модели необходимо отправить тестовую выборку на платформу для получения решающего результата.

В качестве данных для обучения модели получены ретроспективные данные о продажах автомобилей со вторичного рынка за 2014-2015 года. Также получены данные для тестирования модели.

Для решения задачи использовать язык Python (Jupyter Notebook).

## Описание данных

**Источник данных:** https://www.kaggle.com/competitions/copy-of-used-cars-price-prediction-ds18

train.csv - информация о продажах (~440000) автомобилей с аукционов, которые будут использоваться в качестве обучающих данных.
test.csv - информация о продажах (~110000) автомобилей с аукционов, которые будут использоваться в качестве тестовых данных. данные не имеют поля 'sellingprice', при загрузке результата на платформу будет получен результат
sellingprice - Целевой признак. Для каждого автомобиля предскажите числовое значение стоимости автомобиля.

**Описание полей данных:**

'year' - год производства
'make' - производитель
'model' - модель
'trim' - модификация
'body' - тип кузова
'transmission' - тип КПП
'vin' - идентификатор (вин)
'state' - штат регистрации
'condition' - состояние по шкале (1-5)
'odometer' - пробег в милях
'color' - цвет кузова
'interior' - цвет интерьера
'seller' - продавец
'sellingprice' - стоимость продажи
'saledate' - дата продажи

## Цели и этапы решения задачи

**Цель:** реализовать модель позволяющую выяснить предварительную оценку автомобиля.

**Этапы решения задачи:**

1. Изучить данные
2. Обработать данные: заполнить пропуски, вычленить выбросы, убрать явняе и неявные дубликаты.
3. Выделить из обучающей выборки часть данных для тестирования модели
4. Обучить несколько моделей на полученных данных: DecisionTreeRegressor, RandomForestRegressor, GradientBoostingRegressor, CatBoostRegressor
5. Выбрать наилучшие модели и протестировать их на выделенной части данных. Для отбора модели использовать GridSearchCV, главная метрика mean_absolute_percentage_error.
6. Обучить выбранную модель на всех данных обучающей выборки
7. Применить модель для тестовой выборки от заказчика
8. Выложить результат на платформу Kaggle в качестве csv файла в формате vin - price
9. Написать отчет о проделанной работе.

## Результат
В результате проделанной работы было обучено 4 вида регрессионных моделей: DecisionTreeRegressor, HistGradientBoostingRegressor, CatBoostRegressor и RandomForestRegressor
При помощи метода GridSearchCV с помощью метрики MAPE была выбрана модель CatBoostRegressor.
Результирующая модель была применена к тестовой выборке. 
Результат был загружен на платформу kaggle, результат прогнозирования 18.35694. 
Модель адекватна, показывает хороший стабильный результат и может быть использована в качестве модели для прогнозирования цены автомобиля на вторичном рынке.